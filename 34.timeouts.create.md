# Task #34: timeouts.create

## Summary
Verified the `create` timeout default value is correctly set to 30 minutes in the `timeouts` variable in `variables.tf`, matching the provider schema definition.

## Create Phase Verification

**Pattern:** Meta-block (N/A for Azure API)

From the provider source code in `track.md` (lines 128-137):

```go
Timeouts: &pluginsdk.ResourceTimeout{
    Create: pluginsdk.DefaultTimeout(30 * time.Minute),
    Read:   pluginsdk.DefaultTimeout(5 * time.Minute),
    Update: pluginsdk.DefaultTimeout(30 * time.Minute),
    Delete: pluginsdk.DefaultTimeout(30 * time.Minute),
}
```

**Evidence:**
- Default value: **30 minutes**
- This is a resource-level meta-argument for Terraform operations, not an Azure API request body property

## Provider Schema

From `internal/services/containers/container_registry_resource.go` (lines 57-62):

```go
Timeouts: &pluginsdk.ResourceTimeout{
    Create: pluginsdk.DefaultTimeout(30 * time.Minute),
    // ...
}
```

The create timeout is set to 30 minutes using `pluginsdk.DefaultTimeout(30 * time.Minute)`.

## Implementation Verification

The `timeouts` variable in `variables.tf` (lines 323-343) is already correctly configured:

```hcl
variable "timeouts" {
  type = object({
    create = optional(string, "30m")  # <- Default matches provider: 30 minutes
    delete = optional(string, "30m")
    read   = optional(string, "5m")
    update = optional(string, "30m")
  })
  default = {
    create = "30m"  # <- MATCHES type definition: optional(string, "30m")
    delete = "30m"
    read   = "5m"
    update = "30m"
  }
  nullable    = false  # <- REQUIRED: Set to false
  description = <<-EOT
 - `create` - (Optional) Specifies the timeout for create operations. Defaults to 30 minutes.
 - `delete` - (Optional) Specifies the timeout for delete operations. Defaults to 30 minutes.
 - `read` - (Optional) Specifies the timeout for read operations. Defaults to 5 minutes.
 - `update` - (Optional) Specifies the timeout for update operations. Defaults to 30 minutes.
EOT
}
```

**Verification:**
- ✅ Type definition: `create = optional(string, "30m")` - default is 30m
- ✅ Default block: `create = "30m"` - matches type definition exactly
- ✅ Nullable: `nullable = false` - correctly set
- ✅ Description: States "Defaults to 30 minutes" - matches provider

The `migrate_outputs.tf` file already includes the required output:

```hcl
output "timeouts" {
  value = var.timeouts
}
```

## Special Handling

**Timeouts Block Handling:**
- Timeouts are Terraform provider meta-arguments, NOT Azure API properties
- No implementation needed in `migrate_main.tf` (no body/sensitive_body changes)
- Values are passed directly from the variable to the parent module's `azapi_resource` block
- The parent module handles timeouts in its `timeouts` block

**No Shadow Module Changes:**
- The timeouts block is consumed directly by the parent module's `azapi_resource`
- No changes to `local.body`, `local.sensitive_body`, `local.replace_triggers_external_values`, etc.
- The `output "timeouts"` in `migrate_outputs.tf` passes the variable value to the parent module

## Edge Case Analysis

**Null semantics:** The variable has `nullable = false` and a default value, so it cannot be null.

**Boundary conditions:** The timeout value is a string in Go duration format (e.g., "30m", "1h"). Terraform validates the format when parsing.

**Idempotency:** Timeout values are static configuration and do not affect resource state or idempotency.

**Safe references:** The timeout variable is directly referenced in the output, no nested access required.

## Checklist

- ✅ Timeout default value extracted from provider source code (30 minutes)
- ✅ Variable type definition has correct default: `optional(string, "30m")`
- ✅ Variable default block matches type definition: `create = "30m"`
- ✅ Variable has `nullable = false` set correctly
- ✅ Variable description correctly states "Defaults to 30 minutes"
- ✅ Output "timeouts" exists in `migrate_outputs.tf`
- ✅ No shadow module implementation needed (confirmed)
- ✅ Provider schema evidence documented
- ✅ Edge case analysis completed
- ✅ Proof document created
- ✅ Track.md will be updated to "Pending for check"

---

## ✅ CHECKER VALIDATION - APPROVED

**Checked by:** Checker Agent
**Date:** 2026-01-26
**Task:** #34 - timeouts.create

### Validation Results

✅ **Timeout Default Value:** Correctly extracted from provider source code (30 minutes)
✅ **Variable Type Definition:** `optional(string, "30m")` correctly includes default value
✅ **Variable Default Block:** `create = "30m"` exactly matches type definition
✅ **Nullable Setting:** `nullable = false` correctly set (MANDATORY for root-level defaults per executor.md line 147)
✅ **Description:** Correctly states "Defaults to 30 minutes" matching provider
✅ **Output:** `output "timeouts"` exists in migrate_outputs.tf
✅ **Shadow Module:** Correctly no implementation in migrate_main.tf (timeouts are meta-arguments)
✅ **Special Rules:** Followed timeouts.md override document exactly
✅ **Deferred Work:** No following.md file exists - no deferred work to complete
✅ **Edge Cases:** Properly analyzed null handling, boundary conditions, and safe references

### Compliance Statement

This implementation EXACTLY replicates the provider behavior as required by `executor.md` and the special override rules in `timeouts.md`. The timeout default value of 30 minutes is correctly extracted from the provider schema, properly synchronized between the type definition's `optional(string, "30m")` and the default block's `create = "30m"`, and the required `nullable = false` is correctly set. No deviations, simplifications, or "safer alternatives" were found.

**Status:** APPROVED ✅

---
